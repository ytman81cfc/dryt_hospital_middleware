<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.hospital.middleware.healthplatform.dao.his.HealthplatfromDAO">
    <select id="queryMzyzmxb" resultType="java.util.HashMap">
        select a.orgcode                                       "YLJGDM",--	医疗机构代码	VARCHAR	22	必填	复合主键：采用22位“卫生机构代码”
               a.rid                                           "YZLSH",--	医嘱明细流水号	VARCHAR	32	必填	复合主键：医院内部HIS系统唯一编号
               a.RECIPENO                                      "CFH",--	医嘱号	VARCHAR	64	必填	复合主键：用于标注属于同一个医嘱的医嘱明细
               b.orgname                                       "YLJGMC",--	医疗机构名称	VARCHAR	70	必填	医院执业许可第一名称
               '0'                                             "FYDM",--	分院代码	VARCHAR	20	必填	记录分院代码（内码）,如无分院，则传0
               ''                                              "FYMC",--	分院名称	VARCHAR	120	条件必填	分院代码不为0时必填
               a.regid                                         "JZLSH",--	就诊流水号	VARCHAR	32	必填	关联门诊就诊记录表
               '100'                                           "JZLXDM",--	就诊类型代码	VARCHAR	3	必填	参见CVA5101_01就诊类型代码（100：普通门诊 102：专家门诊 103：特需门诊 200：急诊 300：急诊观察 400：普通住院 401：特需住院 500：家床 600：体检 999：其他）
               c.DEPTCODE                                      "JZKSDM",--	院内就诊科室代码	VARCHAR	50	必填
               c.DEPTNAME                                      "JZKSMC",--	院内就诊科室名称	VARCHAR	100	必填
               '-'                                             "ZXJZKSDM",--	中心就诊科室代码	VARCHAR	50	必填	参见 《全民健康信息平台科室分类代码表》
               '-'                                             "ZXJZKSMC",--	中心就诊科室名称	VARCHAR	100	必填	参见 《全民健康信息平台科室分类代码表》
               c.PATIENTNAME                                   "XM",--	姓名	VARCHAR	50	必填
               e.item_id                                       "XB",--	性别	VARCHAR	1	必填	参见 GB/T 2261.1-2003 性别代码表
               to_char(c.BRDY, 'YYYY-MM-DD')                   "CSRQ",--	出生日期	DATETIME		必填	YYYY-MM-DD
               '1'                                             "KLX",--	卡类型	VARCHAR	16	必填	请按照以下优先级顺序填写：1：患者主索引号、2：身份证号、3：医保卡号，如果都没有则填写门诊就诊流水号
               d.rid                                           "KH",--	卡号	VARCHAR	64	必填
               f.item_id                                       "ZJLX",--	证件类型	VARCHAR	2		参见CV02.01.101-2022修订版 身份证件类别代码 优先使用身份证
               c.CERTNO                                        "ZJHM",--	证件号码	VARCHAR	32
               case
                   when c.PAYKINDCODE = '01' then '07'
                   when c.PAYKINDCODE = '02' and c.INSUTYPE = 'A' then '01'
                   when c.PAYKINDCODE = '02' and c.INSUTYPE = 'B' then '02'
                   else '99' end                               "BXLX",--	医疗费用支付方式	VARCHAR	4	必填	参见CV07.10.003-2022修订版 医疗费用来源类别
               x.item_id                                       "YZXMLXDM",--	医嘱项目类型代码	VARCHAR	2	必填	参见CV06.00.229 （01：药品类医嘱 02：检查类医嘱 03：检验类医嘱 04：手术类医嘱 05：处置类医嘱 06：材料类医嘱 07：嘱托医嘱）
               x.item_name                                     "YZXMLXMC",--	医嘱项目类型名称	VARCHAR	32	必填
               a.rid                                           "CFXMMXHM",--	医嘱项目明细唯一标识	VARCHAR	64	必填	"药品类医嘱填写药品处方明细唯一标识 检查类医嘱填写检查明细唯一标识检验类医嘱填写检验明细唯一标识手术类医嘱填写手术医嘱明细唯一标识处置类医嘱填写处置医嘱明细唯一标识材料类医嘱填写材料医嘱明细唯一标识嘱托医嘱填写嘱托医嘱明细唯一标识如无以上标志，则填写医嘱明细流水号"
               a.DOCTCODE                                      "KFSSGH",--	医嘱开立医师工号	VARCHAR	64	必填
               a.DOCTNAME                                      "KFYSXM",--	医嘱开立医师姓名	VARCHAR	50	必填
               u.CERTNO                                        "SFBSHM",--	医嘱开立医师身份证号	VARCHAR	20	必填	开方医生身份证号
               to_char(a.DRAWTIME, 'YYYY-MM-DD hh24:mi:ss')    "KFSJ",--	医嘱开立时间	DATETIME		必填	格式:YYYY-MM-DD HHMMSS
               ''                                              "CFBMBZ",--	处方保密标志	VARCHAR	1		0：否 1：是
               ''                                              "CFBZXX",--	医嘱备注信息	VARCHAR	2000		对医嘱信息的重要提示和补充说明
               case
                   when a.BUSITYPE = '1' then '1'
                   when a.BUSITYPE = '2' then '0'
                   else '' end                                 "ZXYCFBZ",--	中西医处方标志	VARCHAR	1	条件必填	(西药/中药填写)0：中医处方 1：西医处方
               case
                   when a.BUSITYPE = '1' and a.DRUGQUALITY = '4' then '1'
                   when a.BUSITYPE = '1' and a.DRUGQUALITY &lt;&gt; '4' then '0'
                   else ''
                   end                                         "SYYYBZ"
                ,--	是否输液处方	VARCHAR	1	条件必填	(西药填写) 0：否 1：是
               case
                   when a.BUSITYPE in ('1', '2') then i.TOTCOST
                   else null
                   end                                         "CFZJE"
                ,--	处方总金额	NUMERIC	18,3	条件必填	(西药/中药填写)该医嘱所属处方的总金额
               case
                   when a.BUSITYPE in ('1', '2') then '0'
                   else ''
                   end                                         "TYBZ"
                ,--	退药标志	VARCHAR	1	条件必填	(西药/中药填写)0：否 1：是
               case
                   when a.BUSITYPE in ('1', '2') then a.DEMAND
                   else ''
                   end                                         "YZMD"
                ,--	药嘱目的	VARCHAR	50		(西药/中药填写)药嘱开具的目的，如科室领药、带手术室等
               case
                   when a.BUSITYPE in ('1', '2') then decode(a.DRUGTYPE, '1', '1', '2', '2', '3', '3')
                   else ''
                   end                                         "YPLB"
                ,--	药品类别	VARCHAR	1	条件必填	(西药/中药填写) 1：西药 2：中成药 3：中草药
               case
                   when a.BUSITYPE in ('1', '2') then decode(a.OWNFLAG, '0', '1', '1', '2')
                   else ''
                   end                                         "YPLYDM"
                ,--	药品来源	VARCHAR	2	条件必填	(西药/中药填写) 1：医院药品 2：自备药品
               case
                   when a.BUSITYPE in ('1', '2') then '-'
                   else ''
                   end                                         "CFFLDM"
                ,--	药品处方分类代码	VARCHAR	2	条件必填	(西药/中药填写) 参照 ZD_CFFLDM处方分类代码
               case
                   when a.BUSITYPE in ('1', '2') then a.RECIPENO
                   else ''
                   end                                         "YZBH"
                ,--	处方组号	VARCHAR	32	条件必填	(西药/中药填写) 标识同一组药物
               case
                   when a.BUSITYPE in ('1', '2') then '-'
                   else ''
                   end                                         "ZYBZ"
                ,--	主药标志	VARCHAR	2	条件必填	(西药/中药填写) 0：否 1：是
               case
                   when a.BUSITYPE in ('1', '2') then to_char(a.ORDERNO)
                   else ''
                   end                                         "ZLXH"
                ,--	组类序号	VARCHAR	64	条件必填	(西药/中药填写) 一组药品的排序序号
               case
                   when a.BUSITYPE in ('1', '2') then decode(a.ISSKINTEST, '1', '0', '2', '1')
                   else ''
                   end                                         "PSPB"
                ,--	是否皮试	VARCHAR	1	条件必填	(西药填写) 0：否 1：是
               case
                   when a.BUSITYPE in ('1', '2') then p.GJYPID
                   else ''
                   end                                         "YPID"
                ,--	国家药品ID	VARCHAR	64	条件必填	(西药/中药填写)三级医院必填,二级医院有条件的填  填写国家药管平台药品采购唯一性识别码YPID（V8.3）V8.3版本中不包含的药品填“-”。
               case
                   when a.BUSITYPE in ('1', '2') then a.ITEMCODE
                   else ''
                   end                                         "YPDMNBBM"
                ,--	药物代码	VARCHAR	32	条件必填	(西药/中药填写)医院内部编码
               case
                   when a.BUSITYPE in ('1', '2') then a.ITEMNAME
                   else ''
                   end                                         "YPMC"
                ,--	药物名称	VARCHAR	200	条件必填	(西药/中药填写)
               case
                   when a.BUSITYPE in ('1', '2') then h.item_id
                   else ''
                   end                                         "YWLX"
                ,--	药物类型	VARCHAR	12		(西药/中药填写)参见ZD_YL_YPFL药品分类与编码
               case
                   when a.BUSITYPE in ('1', '2') then a.SPECS
                   else ''
                   end                                         "YPGG"
                ,--	药品规格	VARCHAR	32	条件必填	(西医/中成药填写)
               case
                   when a.BUSITYPE in ('1', '2') then a.DOSEMODELCODE
                   else ''
                   end                                         "YNYWJXDM"
                ,--	院内药物剂型代码	VARCHAR	10	条件必填	(西医/中成药填写)院内药物剂型代码
               case
                   when a.BUSITYPE in ('1', '2') then a.DOSEMODELNAME
                   else ''
                   end                                         "YNYWJXMC"
                ,--	院内药物剂型名称	VARCHAR	128	条件必填	(西医/中成药填写)院内药物剂型名称
               case
                   when a.BUSITYPE in ('1', '2') then l.item_id
                   else ''
                   end                                         "YWJXDM"
                ,--	中心药物剂型代码	VARCHAR	3	条件必填	(西医/中成药填写)参见CV08.50.002药物剂型代码表
               case
                   when a.BUSITYPE in ('1', '2') then l.item_name
                   else ''
                   end                                         "YWJXMC"
                ,--	中心药物剂型名称	VARCHAR	128	条件必填	(西医/中成药填写)
               case
                   when a.BUSITYPE in ('1', '2') then round(a.DOSEONCE, 3)
                   else null
                   end                                         "JL"
                ,--	药物使用次剂量	NUMERIC	15,3	条件必填	(西医/中成药填写)
               case
                   when a.BUSITYPE in ('1', '2') then '-'
                   else ''
                   end                                         "JLDWDM"
                ,--	药物使用次剂量单位代码	VARCHAR	64	条件必填	(西医/中成药填写)参见 CVA08.03.014 药物使用剂量单位
               case
                   when a.BUSITYPE in ('1', '2') then '-'
                   else ''
                   end                                         "JLDW"
                ,--	药物使用次剂量单位名称	VARCHAR	64	条件必填	(西医/中成药填写)
               case
                   when a.BUSITYPE in ('1', '2') then a.FREQCODE
                   else ''
                   end                                         "YNYWSYPLDM"
                ,--	院内药物使用频率代码	VARCHAR	32	条件必填	(西医/中成药填写)
               case
                   when a.BUSITYPE in ('1', '2') then a.FREQNAME
                   else ''
                   end                                         "YNYWSYPLMC"
                ,--	院内药物使用频率名称	VARCHAR	128	条件必填	(西医/中成药填写)
               case
                   when a.BUSITYPE in ('1', '2') then m.item_id
                   else ''
                   end                                         "YWSYPL"
                ,--	中心药物使用频率代码	VARCHAR	32	条件必填	(西医/中成药填写)参见CVA5301_01 药物使用频率
               case
                   when a.BUSITYPE in ('1', '2') then m.item_name
                   else ''
                   end                                         "YWSYPLMC"
                ,--	中心药物使用频率名称	VARCHAR	128	条件必填	(西医/中成药填写)
               case
                   when a.BUSITYPE in ('1', '2') then a.DAYS
                   else null
                   end                                         "CFTS"
                ,--	用药天数	NUMERIC	3	条件必填	(西医/中药填写)用药天数　
               null                                            "YWSYZSL",--	药物使用总剂量	NUMERIC	10,3	条件必填	(西药/中药填写)药物使用的总剂量
               case
                   when a.BUSITYPE in ('1', '2') then '-'
                   else ''
                   end                                         "YWSYZSLDWDM"
                ,--	药物使用总剂量单位代码	VARCHAR	64	条件必填	(西药/中药填写)参见 CVA08.03.014 药物使用剂量单位
               case
                   when a.BUSITYPE in ('1', '2') then '-'
                   else ''
                   end                                         "YWSYZSLDW"
                ,--	药物使用总剂量单位名称	VARCHAR	20	条件必填	(西药/中药填写)
               case
                   when a.BUSITYPE in ('1', '2') then a.USAGECODE
                   else ''
                   end                                         "YNYWSYTJDM"
                ,--	院内药物使用途径代码	VARCHAR	32	条件必填	(西医/中成药填写)
               case
                   when a.BUSITYPE in ('1', '2') then a.USAGENAME
                   else ''
                   end                                         "YNYWSYTJMC"
                ,--	院内药物使用途径名称	VARCHAR	128	条件必填	(西医/中成药填写)
               case
                   when a.BUSITYPE in ('1', '2') then n.item_id
                   else ''
                   end                                         "YWSYTJDM"
                ,--	中心药物使用途径代码	VARCHAR	32	条件必填	(西医/中成药填写)参见CV06.00.102用药途径代码
               case
                   when a.BUSITYPE in ('1', '2') then n.item_name
                   else ''
                   end                                         "YWSYTJMC"
                ,--	中心药物使用途径名称	VARCHAR	128	条件必填	(西医/中成药填写)
               case
                   when a.BUSITYPE in ('1', '2') then '-'
                   else ''
                   end                                         "GYSJ"
                ,--	给药时机	VARCHAR	50		(西医/中成药填写)如：饭前、饭后、空腹等
               case
                   when a.BUSITYPE in ('1', '2') then o.EXECDPCD
                   else ''
                   end                                         "YNFYKSDM"
                ,--	院内发药科室编码	VARCHAR	50		(西药/中药填写)
               case
                   when a.BUSITYPE in ('1', '2') then o.EXECDPNM
                   else ''
                   end                                         "YNFYKSMC"
                ,--	院内发药科室名称	VARCHAR	100		(西药/中药填写)
               case
                   when a.BUSITYPE in ('1', '2') then '-'
                   else ''
                   end                                         "FYKSDM"
                ,--	发药科室编码	VARCHAR	50		(西药/中药填写)
               case
                   when a.BUSITYPE in ('1', '2') then '-'
                   else ''
                   end                                         "FYKSMC"
                ,--	发药科室名称	VARCHAR	100		(西药/中药填写)
               case
                   when a.BUSITYPE in ('1', '2') then a.DOCTCODE
                   else ''
                   end                                         "SHYJSGH"
                ,--	审核药剂师工号	VARCHAR	64		(西药/中药填写)
               case
                   when a.BUSITYPE in ('1', '2') then a.DOCTNAME
                   else ''
                   end                                         "SHYJSXM"
                ,--	审核药剂师姓名	VARCHAR	50		(西药/中药填写)
               case
                   when a.BUSITYPE in ('1', '2') then u.CERTNO
                   else ''
                   end                                         "SHYJSSFZHM"
                ,--	审核药剂师身份证号码	VARCHAR	18		(西药/中药填写)
               case
                   when a.BUSITYPE in ('1', '2') then o.SENDCODE
                   else ''
                   end                                         "FYYJSGH"
                ,--	发药药剂师工号	VARCHAR	64		(西药/中药填写)
               case
                   when a.BUSITYPE in ('1', '2') then o.SENDNAMRE
                   else ''
                   end                                         "FYYJSXM"
                ,--	发药药剂师姓名	VARCHAR	50		(西药/中药填写)
               case
                   when a.BUSITYPE in ('1', '2') then s.CERTNO
                   else ''
                   end                                         "FYYJSSFZHM"
                ,--	发药药剂师身份证号码	VARCHAR	18		(西药/中药填写)
               to_char(o.SENDDATE, 'yyyy-mm-dd hh24:mi:ss')    "CFFYRQSJ",--	发药时间	DATETIME			(西药/中药填写)处方开立时可以不传，发药后更新，YYYY-MM-DD HH24:MM:SS
               case
                   when a.BUSITYPE in ('1', '2') then to_char(o.QTY)
                   else ''
                   end                                         "FYSL"
                ,--	发药数量	VARCHAR	8		(西药/中药填写)本次处方该药品的总数量，如：“2 盒”中的“2”
               case
                   when a.BUSITYPE in ('1', '2') then q.dictname
                   else ''
                   end                                         "FYSLDWMC"
                ,--	发药数量单位	VARCHAR	10		(西药/中药填写)本次处方该药品的总数量单位，如：“2 盒”中的“盒”
               case
                   when a.BUSITYPE = '2' then '9'
                   else ''
                   end                                         "ZYCFFL"
                ,--	中药处方分类	VARCHAR	1		(中药填写)1：散装饮片 2：小包装饮片 3：颗粒剂 4：协定 5：膏方 6：中药制剂 9：其他
               case
                   when a.BUSITYPE = '2' then '-'
                   else ''
                   end                                         "FJMC"
                ,--	方剂名称	VARCHAR	200		(中草药填写)根据配伍原则，总结临床经验，以若干药物配合组成的药方（有多个时以“|”分隔）
               case
                   when a.BUSITYPE = '2' then r.item_id
                   else ''
                   end                                         "YYFFDM"
                ,--	用药方法代码	VARCHAR	2	条件必填	(中草药填写) 01：口服 02：水煎服 03：热服 04：熬膏服 05：制丸 06：装胶囊 07：冲化 08：打粉 09：煎洗 10：泡脚 11：漱口 12：灌肠 13：外用 99：其他
               case
                   when a.BUSITYPE = '2' then r.item_name
                   else ''
                   end                                         "YYFFMS"
                ,--	用药方法描述	VARCHAR	200	条件必填	(中草药填写) 如“7 剂，每日1剂，水煎至 400ml（每包 200ml），分早晚两次温服”
               case
                   when a.BUSITYPE = '2' then v.item_id
                   else ''
                   end                                         "SYPCDM"
                ,--	用药频次代码	VARCHAR	2	条件必填	(中草药填写) 01：每日一剂 02：每日二剂 03：每日三剂 04：每日一次 05：每日二次 06：每日三次 07：每日多次 99：其他
               case
                   when a.BUSITYPE = '2' then v.item_name
                   else ''
                   end                                         "SYPCMS"
                ,--	用药频次描述	VARCHAR	300	条件必填	(中草药填写)
               case
                   when a.BUSITYPE = '2' then REGEXP_SUBSTR(a.HERMEDDOSENUM, '[0-9]+')
                   else null
                   end                                         "YCYL"
                ,--	一次用量（ml）	NUMERIC	5		(中草药填写)
               ''                                              "YCYLMS",--	一次用量描述	VARCHAR	300		(中草药填写)不能量化成毫升的用量填入此字段。
               case
                   when a.BUSITYPE = '2' then decode(a.FRIEDTYPE, '1', '2', '2', '1')
                   else ''
                   end                                         "JYFSDM"
                ,--	煎药方式代码	VARCHAR	1	条件必填	(中草药填写) 1：自煎 2：代煎
               ''                                              "JJFYJE",--	煎药费用金额	NUMERIC	18,3	条件必填	(中草药填写) 煎药费用，煎药方式为代煎时填写，单位为分
               case
                   when a.BUSITYPE = '2' then round(o.QTY / o.DAYS, 2)
                   else 0
                   end                                         "DTSYL"
                ,--	单帖使用量	NUMERIC	8,2	条件必填	(中草药填写) 一帖药中某味药的使用量。如：“麦冬 12g”中的“12”
               case
                   when a.BUSITYPE = '2' then w.item_id
                   else ''
                   end                                         "DTSYDWDM"
                ,--	单帖使用量单位代码	VARCHAR	10	条件必填	(中草药填写) 1：克（g） 2：毫升（ml） 3：只 4：条 5：枚
               case
                   when a.BUSITYPE = '2' then w.item_name
                   else ''
                   end                                         "DTSYDWMC"
                ,--	单帖使用量单位名称	VARCHAR	20	条件必填	(中草药填写)
               case
                   when a.BUSITYPE = '2' then to_char(a.ITEMPRICE)
                   else ''
                   end                                         "YPJE"
                ,--	药品单价	VARCHAR	10	条件必填	(中医填写) 单位数量药品的计价金额，计价单位与单帖使用量单位相同，单位：分
               case
                   when a.BUSITYPE = '2' then a.USAGECODE
                   else ''
                   end                                         "YNJYDM"
                ,--	院内中药煎煮法代码	VARCHAR	4		(中草药填写) 院内中药煎煮法代码
               case
                   when a.BUSITYPE = '2' then a.USAGENAME
                   else ''
                   end                                         "YNJYMC"
                ,--	院内中药煎煮法名称	VARCHAR	128		(中草药填写) 院内中药煎煮法名称
               case
                   when a.BUSITYPE = '2' then '-'
                   else ''
                   end                                         "ZCJZFDM"
                ,--	中心中药煎煮法代码	VARCHAR	4		(中草药填写) 参考CVA08.03.012平台中药煎煮法代码
               case
                   when a.BUSITYPE = '2' then '-'
                   else ''
                   end                                         "JYMC"
                ,--	中心中药煎煮法名称	VARCHAR	128		(中草药填写)
               case
                   when a.BUSITYPE = '2' then '-'
                   else ''
                   end                                         "JZFFMS"
                ,--	中药煎煮法描述	VARCHAR	200	条件必填	(中草药填写) 一帖药的煎煮方法。如“水煎“
               case
                   when a.BUSITYPE = '2' then o.DAYS
                   else null
                   end                                         "CYTS"
                ,--	草药帖数	NUMERIC	3	条件必填	(中草药填写)
               case
                   when a.BUSITYPE not in ('1', '2') then a.ITEMCODE
                   else ''
                   end                                         "FUXMYYDM"
                ,--	项目代码	VARCHAR	32		医院内部编码，非药品医嘱必填
               case
                   when a.BUSITYPE not in ('1', '2') then a.ITEMNAME
                   else ''
                   end                                         "FWXMMC"
                ,--	项目名称	VARCHAR	200		医院内部编码，非药品医嘱必填
               case
                   when a.BUSITYPE not in ('1', '2') then round(a.ITEMPRICE, 3)
                   else null
                   end                                         "XMDJ"
                ,--	项目单价	NUMERIC	18,3
               case
                   when a.BUSITYPE not in ('1', '2') then round(a.TOTCOST, 3)
                   else null
                   end                                         "XMJE"
                ,--	项目金额	NUMERIC	18,3
               nvl(replace(t.MED_LIST_CODG, '_SI', ''), '999') "ZXDM",--	中心药品/项目代码	VARCHAR	32	必填	"药品类填写药品医保编码，如非医保药品，则传999检查类参见《全民健康信息平台检查分类编码标准》检验类参见《全民健康信息平台检验分类编码标准》手术类参见《手术操作分类代码(ICD-9)》处置类医嘱填写《全民健康信息平台医疗服务项目价格表》材料类参见《国家医保医用耗材分类编码》嘱托类填写888"
               a.itemname                                      "ZXXMMC",--	中心药品/项目名称	VARCHAR	200	必填
               to_char(a.UPDT_TIME, 'yyyy-mm-dd hh24:mi:ss')   "SJGXSJ",--	数据更新时间	DATETIME		必填	院内处方数据更新时间。YYYY-MM-DD HH24:MI:SS格式
               to_char(sysdate, 'YYYY-MM-DD')                  "TBRQ" --	填报日期	DATETIME	 必填	本条数据采集时间，格式YYYY-MM-DD
        from OPM_RECIPE_INFO i,
             com_hospitalinfo b,
             com_patientinfo d,
             pha_druginfo p
                 left join fin_item_compare t on t.orgcode = p.orgcode and t.ITEMCODE = p.drugcode,
             OPB_FEEDETAIL o
                 left join com_userinfo s
                           on o.orgcode = s.orgcode and o.SENDCODE = s.usercode and s.isvalid = '1' and s.is_stop = '0'
                 left join com_dictcodeinfo q on q.typecode = 'MINUNIT' and q.dictcode = o.PRICEUNIT,
             OPM_RECIPE_DETAIL a
                 left join com_userinfo u
                           on a.orgcode = u.orgcode and a.DOCTCODE = u.usercode and u.isvalid = '1' and u.is_stop = '0'
                 left join (select a.item_id, b.his_item_id
                            from si_yt_report_item a,
                                 si_yt_report_item_compare b
                            where a.module_rid = b.module_rid
                              and a.type_rid = b.type_rid
                              and a.rid = b.item_rid
                              and a.module_rid = '202310101511361148853000000000'
                              and a.type_rid = '202310101604171149584500000000') h on h.his_item_id = a.DRUGQUALITY
                 left join (select a.item_id, a.item_name, b.his_item_id
                            from si_yt_report_item a,
                                 si_yt_report_item_compare b
                            where a.module_rid = b.module_rid
                              and a.type_rid = b.type_rid
                              and a.rid = b.item_rid
                              and a.module_rid = '202310101511361148853000000000'
                              and a.type_rid = '202310111417281155108400000000') x on x.his_item_id = a.BUSITYPE
                 left join (select a.item_id, a.item_name, b.his_item_id
                            from si_yt_report_item a,
                                 si_yt_report_item_compare b
                            where a.module_rid = b.module_rid
                              and a.type_rid = b.type_rid
                              and a.rid = b.item_rid
                              and a.module_rid = '202310101511361148853000000000'
                              and a.type_rid = '202310101606231149584700000000') l on l.his_item_id = a.DOSEMODELCODE
                 left join (select a.item_id, a.item_name, b.his_item_id
                            from si_yt_report_item a,
                                 si_yt_report_item_compare b
                            where a.module_rid = b.module_rid
                              and a.type_rid = b.type_rid
                              and a.rid = b.item_rid
                              and a.module_rid = '202310101511361148853000000000'
                              and a.type_rid = '202310101607011149584800000000') m on m.his_item_id = a.FREQCODE
                 left join (select a.item_id, a.item_name, b.his_item_id
                            from si_yt_report_item a,
                                 si_yt_report_item_compare b
                            where a.module_rid = b.module_rid
                              and a.type_rid = b.type_rid
                              and a.rid = b.item_rid
                              and a.module_rid = '202310101511361148853000000000'
                              and a.type_rid = '202310121416061161347000000000') r on r.his_item_id = a.FREQCODE
                 left join (select a.item_id, a.item_name, b.his_item_id
                            from si_yt_report_item a,
                                 si_yt_report_item_compare b
                            where a.module_rid = b.module_rid
                              and a.type_rid = b.type_rid
                              and a.rid = b.item_rid
                              and a.module_rid = '202310101511361148853000000000'
                              and a.type_rid = '202310101607531149585000000000') n on n.his_item_id = a.USAGECODE
                 left join (select a.item_id, a.item_name, b.his_item_id
                            from si_yt_report_item a,
                                 si_yt_report_item_compare b
                            where a.module_rid = b.module_rid
                              and a.type_rid = b.type_rid
                              and a.rid = b.item_rid
                              and a.module_rid = '202310101511361148853000000000'
                              and a.type_rid = '202310101607531149585000000000') v on v.his_item_id = a.USAGECODE
                 left join (select a.item_id, a.item_name, b.his_item_id
                            from si_yt_report_item a,
                                 si_yt_report_item_compare b
                            where a.module_rid = b.module_rid
                              and a.type_rid = b.type_rid
                              and a.rid = b.item_rid
                              and a.module_rid = '202310101511361148853000000000'
                              and a.type_rid = '202310121544581161848300000000') w on w.his_item_id = a.DOSEUNIT,
             opr_register c
                 left join (select a.item_id, b.his_item_id
                            from si_yt_report_item a,
                                 si_yt_report_item_compare b
                            where a.module_rid = b.module_rid
                              and a.type_rid = b.type_rid
                              and a.rid = b.item_rid
                              and a.module_rid = '202310101511361148853000000000'
                              and a.type_rid = '202310101521161149402900000000') e on e.his_item_id = c.SEXCODE
                 left join (select a.item_id, b.his_item_id
                            from si_yt_report_item a,
                                 si_yt_report_item_compare b
                            where a.module_rid = b.module_rid
                              and a.type_rid = b.type_rid
                              and a.rid = b.item_rid
                              and a.module_rid = '202310101511361148853000000000'
                              and a.type_rid = '202310101602441149584100000000') f on f.his_item_id = c.PSNCERTTYPE

        where a.orgcode = i.orgcode
          and a.REGID = i.REGID
          and a.RECIPENO = i.RECIPENO
          and i.CHARSTATUS = '2'
          and a.orgcode = b.orgcode
          and a.orgcode = c.orgcode
          and a.REGID = c.REGID
          and c.orgcode = d.orgcode
          and c.patientno = d.patientno
          and c.patientid = d.patientid
          and a.orgcode = p.orgcode
          and a.ITEMCODE = p.DRUGCODE
          and p.ISVALID = '1'
          and p.ISSTOP = '0'
          and a.orgcode = #{orgcode}
          and to_char(i.DRAWTIME, 'yyyy-mm-dd hh24:mi:ss') &gt;= #{begtime}
          and to_char(i.DRAWTIME, 'yyyy-mm-dd hh24:mi:ss') &lt;= #{endtime}
    </select>


</mapper>